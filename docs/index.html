<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
  <meta name="theme-color" content="#6c47ff" />
  <meta name="description"
    content="AI Marketing Automation Platform â€“ Create, Optimize & Share High-Conversion Content" />
  <title>KRK Growth Engine â€“ AI Marketing Platform</title>
  <link rel="manifest" href="manifest.json" />
  <link rel="apple-touch-icon" href="icons/icon-192.png" />
  <link rel="stylesheet" href="style.css" />
  <script>
    // Auth guard â€“ redirect to login if no session
    (function () {
      try {
        var s = JSON.parse(localStorage.getItem('krk_session'));
        if (!s || !s.name) { window.location.href = 'login.html'; }
      } catch (e) { window.location.href = 'login.html'; }
    })();
  </script>
</head>

<body>
  <div class="bg-orbs">
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>
  </div>

  <div id="app">
    <!-- SIDEBAR -->
    <nav class="sidebar" id="sidebar">
      <div class="sidebar-logo">
        <div class="logo-icon">ğŸ”¥</div>
        <div class="logo-text">KRK Growth Engine <span>Â· AI Marketing Platform</span></div>
      </div>
      <span class="nav-section-label">Main</span>
      <a class="nav-item active" data-page="dashboard" onclick="navigate('dashboard')">
        <span class="nav-icon">ğŸ“Š</span> Dashboard
      </a>
      <a class="nav-item" data-page="content" onclick="navigate('content')">
        <span class="nav-icon">âœ¨</span> AI Content Engine
        <span
          style="margin-left:auto;font-size:9px;font-weight:700;background:linear-gradient(135deg,#6c47ff,#ff47c7);color:white;padding:2px 7px;border-radius:10px;">NEW</span>
      </a>
      <a class="nav-item" data-page="campaign" onclick="navigate('campaign')">
        <span class="nav-icon">ğŸš€</span> Campaign Builder
      </a>
      <a class="nav-item" data-page="calendar" onclick="navigate('calendar')">
        <span class="nav-icon">ğŸ“…</span> Content Calendar
      </a>
      <span class="nav-section-label">Growth</span>
      <a class="nav-item" data-page="share" onclick="navigate('share')">
        <span class="nav-icon">ğŸ“¤</span> Multi-Share Hub
      </a>
      <a class="nav-item" data-page="leads" onclick="navigate('leads')">
        <span class="nav-icon">ğŸ¯</span> Lead Capture
      </a>
      <a class="nav-item" data-page="viral" onclick="navigate('viral')">
        <span class="nav-icon">âš¡</span> Viral Predictor
      </a>
      <a class="nav-item" data-page="gamification" onclick="navigate('gamification')">
        <span class="nav-icon">ğŸ†</span> My Progress
      </a>
      <span class="nav-section-label">Specialty</span>
      <a class="nav-item" data-page="insurance" onclick="navigate('insurance')">
        <span class="nav-icon">ğŸ›¡ï¸</span> Insurance Mode
      </a>
      <a class="nav-item" data-page="admin" onclick="navigate('admin')">
        <span class="nav-icon">âš™ï¸</span> Admin Panel
      </a>
      <div class="sidebar-footer">
        <div
          style="display:flex;align-items:center;gap:10px;padding:12px; background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-sm);">
          <div class="avatar" id="sidebarAvatar">K</div>
          <div style="flex:1;min-width:0;">
            <div style="font-size:13px;font-weight:600;" id="sidebarName">KRK User</div>
            <div style="font-size:11px;color:var(--text-secondary);" id="sidebarRole">Growth Pro</div>
          </div>
          <label class="toggle" title="Dark/Light Mode">
            <input type="checkbox" id="themeToggle" onchange="toggleTheme()" />
            <span class="toggle-slider"></span>
          </label>
        </div>
        <button onclick="logoutUser()"
          style="width:100%;margin-top:8px;padding:8px;background:rgba(255,71,71,0.1);color:#ff7070;border:1px solid rgba(255,71,71,0.2);border-radius:8px;cursor:pointer;font-size:12px;font-weight:600;">ğŸšª
          Logout</button>
      </div>
    </nav>

    <!-- MAIN -->
    <div class="main" id="main">
      <!-- TOPBAR -->
      <div class="topbar">
        <div class="topbar-left">
          <button class="hamburger" id="hamburger" onclick="toggleSidebar()">
            <span></span><span></span><span></span>
          </button>
          <div>
            <div class="topbar-title" id="topbarTitle">Dashboard</div>
            <div class="topbar-subtitle" id="topbarSubtitle">Welcome back ğŸ‘‹</div>
          </div>
        </div>
        <div class="topbar-actions">
          <button class="btn-icon" onclick="showInstallPrompt()" title="Install App" id="installBtn"
            style="background:linear-gradient(135deg,rgba(108,71,255,0.3),rgba(255,71,199,0.3));border:1px solid rgba(108,71,255,0.4);">ğŸ“²</button>
          <button class="btn-icon" style="position:relative;" onclick="navigate('leads')">
            ğŸ””<span class="notif-dot"></span>
          </button>
          <div class="avatar" id="topbarAvatar" onclick="navigate('gamification')">K</div>
        </div>
      </div>

      <!-- PAGE CONTAINER -->
      <div id="pageContainer" class="page-content animate-in"></div>
    </div>

    <!-- BOTTOM NAV -->
    <nav class="bottom-nav">
      <div class="bottom-nav-items">
        <button class="bottom-nav-item active" data-page="dashboard" onclick="navigate('dashboard')">
          <span class="bn-icon">ğŸ“Š</span><span class="bn-label">Home</span>
        </button>
        <button class="bottom-nav-item" data-page="content" onclick="navigate('content')">
          <span class="bn-icon">âœ¨</span><span class="bn-label">Create</span>
        </button>
        <button class="bottom-nav-item" data-page="share" onclick="navigate('share')">
          <span class="bn-icon">ğŸ“¤</span><span class="bn-label">Share</span>
        </button>
        <button class="bottom-nav-item" data-page="leads" onclick="navigate('leads')">
          <span class="bn-icon">ğŸ¯</span><span class="bn-label">Leads</span>
        </button>
        <button class="bottom-nav-item" data-page="gamification" onclick="navigate('gamification')">
          <span class="bn-icon">ğŸ†</span><span class="bn-label">Progress</span>
        </button>
      </div>
    </nav>
  </div>

  <!-- TOAST CONTAINER -->
  <div class="toast-container" id="toastContainer"></div>

  <!-- INSTALL BANNER (shown when install prompt available) -->
  <div id="installBanner"
    style="display:none;position:fixed;bottom:80px;left:50%;transform:translateX(-50%);z-index:9999;background:linear-gradient(135deg,#6c47ff,#ff47c7);color:white;padding:14px 20px;border-radius:16px;box-shadow:0 8px 32px rgba(108,71,255,0.5);display:flex;align-items:center;gap:12px;max-width:340px;width:90%;">
    <span style="font-size:24px;">ğŸ“²</span>
    <div style="flex:1;">
      <div style="font-weight:700;font-size:14px;">Install KRK Growth Engine</div>
      <div style="font-size:11px;opacity:0.85;">Add to home screen for quick access</div>
    </div>
    <button onclick="triggerInstall()"
      style="background:white;color:#6c47ff;border:none;border-radius:8px;padding:8px 14px;font-weight:700;font-size:13px;cursor:pointer;">Install</button>
    <button onclick="document.getElementById('installBanner').style.display='none'"
      style="background:transparent;border:none;color:white;font-size:18px;cursor:pointer;padding:0 4px;">âœ•</button>
  </div>

  <!-- SHARE MODAL -->
  <div class="modal-overlay" id="shareModal">
    <div class="modal">
      <div class="modal-handle"></div>
      <div class="modal-title">ğŸ“¤ Share Content</div>
      <div id="shareModalCaption"
        style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius-sm);padding:14px;font-size:14px;margin-bottom:16px;color:var(--text-secondary);line-height:1.6;">
      </div>
      <button class="btn btn-ghost" style="width:100%;margin-bottom:20px;" onclick="copyCaption()">ğŸ“‹ Copy Caption to
        Clipboard</button>
      <div class="share-grid" id="shareModalGrid" style="gap:14px;"></div>
      <button class="btn btn-outline" style="width:100%;margin-top:20px;padding:16px;"
        onclick="closeModal('shareModal')">âœ• Close</button>
    </div>
  </div>

  <script src="data.js"></script>
  <script src="app.js"></script>
  <script src="pages2.js"></script>
  <script src="pages3.js"></script>
  <script>
    // Init: load session info then go to dashboard
    loadUserSession();
    navigate('dashboard');
  </script>
</body>


</html>